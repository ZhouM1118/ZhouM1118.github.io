<!DOCTYPE html>
<html lang="en">

	
	    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <meta content="如何使用N-gram语言模型来进行篇章单元分类？" name="description">
  
  
    <meta name="keywords" content="N-gram, 篇章单元分类">
  
  <meta name="author" content="周明">

  <title>
    
        周明的技术博客|如何使用N-gram语言模型来进行篇章单元分类？
    
  </title>
  <!-- favicon -->
  <link rel="shortcut icon" href="/static/assets/img/favicon.ico">

  <!-- Main CSS -->
  <link href="/static/assets/app-20170521.min.css" rel="stylesheet">

  <!-- Main Scripts -->
  <script src="/static/assets/app-20170521.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      var initial = 0;
      var show = true;

      var toggleSearch = function (visible) {
        initial = 0;
        show = !visible;
        var visibility = visible ? 'block' : 'none';

        $("#search-content").val("");
        $(".search-tool").css("display", visibility);
      };

      var shouldToggle = function (time) {
        var gap = time - initial;
        initial = time;
        return gap < 500;
      };

      $(document).keyup(function (e) {
        var now = new Date().getTime();
        if (e.keyCode == 17 && shouldToggle(now)) {
          toggleSearch(show);
        } else if (e.keyCode == 27) {
          toggleSearch(false);
        }
      });

      $("#search-content").keyup(function (e) {
        var now = new Date().getTime();
        if (e.keyCode == 17 && shouldToggle(now)) {
          toggleSearch(show);
        }
      });

      $("#close-btn").click(function () {
        toggleSearch(false);
      });

      $("#search-btn").click(function() {
        toggleSearch(true);
      });

      $.getJSON("/search/cb-search.json")
        .done(function (data) {
          if (data.code == 0) {
            $("#search-content").typeahead({
              source: data.data,
              displayText: function (item) {
                return item.title;
              },
              afterSelect: function (item) {
                window.location.href = item.url;
              }
            });
          }
        });
    });
    $(function(){
        $("pre").css('display','block');
    });
  </script>
</head>

	

<body id="page-top" class="landing-page">

	
	    <div class="search-tool"
      style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right:  0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;">
    <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog">

    <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;">
        <img src="/search/img/cb-close.png" id="close-btn"/>
    </div>
</div>

<div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;">
    <img src="/search/img/cb-search.png"  id="search-btn"  title="Double click Ctrl"/>
</div>

<div class="navbar-wrapper">
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">周明的技术博客</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a class="page-scroll" href="blog/"></a></li>
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/blog/">Blog</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/java/">Java</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/javascript/">Javascript</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/database/">Database</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/python/">Python</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/linux/">Linux</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/DataMining/">DataMining</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/DeepLearning/">DeepLearning</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/life/">Life</a></li>
                        
                    
                        
                        
                        <li>
                        
                        <a class="page-scroll" href="/donate/">Donate</a></li>
                        
                    
                </ul>
            </div>
        </div>
    </nav>
</div>
<div id="inSlider" class="carousel carousel-fade" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#inSlider" data-slide-to="0" class="active"></li>
        <li data-target="#inSlider" data-slide-to="1"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active">
            <div class="container">
                <div class="carousel-caption">
                </div>
                <div class="carousel-image wow zoomIn">
                    <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> -->
                </div>
            </div>
            <!-- Set background for slide in css -->
            <div class="header-back one"></div>

        </div>
        <div class="item">
            <div class="container">
                <div class="carousel-caption blank">
                </div>
            </div>
            <!-- Set background for slide in css -->
            <div class="header-back two"></div>
        </div>
    </div>
    <a class="left carousel-control" href="#inSlider" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#inSlider" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>

	

    <div class="wrapper wrapper-content  animated fadeInRight article">
    <div class="row">
        <div class="col-lg-10 col-lg-offset-1">
            <div class="ibox">
                <div class="ibox-content">
                    <div class="pull-right">
                    	
                        	<button class="btn btn-white btn-xs" type="button">Deeplearning</button>
                        
                    </div>
                    <div class="text-center article-title">
                    <span class="text-muted"><i class="fa fa-clock-o"></i> 31 Oct 2017</span>
                        <h1>
                            如何使用N-gram语言模型来进行篇章单元分类？
                        </h1>
                    </div>
                    	<h2 id="一-什么是n-gram语言模型language-model"><strong>一、 什么是N-gram语言模型(Language Model)</strong></h2>

<p>N-gram是自然语言处理（NLP）中一个非常重要的概念，通常在NLP中，人们基于一定的语料库，可以利用N-gram来做以下几类事情：</p>

<ol>
  <li>预计或者评估一个句子是否合理；</li>
  <li>评估两个字符串之间的差异程度，这也是模糊匹配中常用的一种手段；</li>
  <li>语音识别；</li>
  <li>机器翻译；</li>
  <li>文本分类。</li>
</ol>

<p>我们主要使用N-gram语言模型来进行文本分类。假定S表示某个有意义的句子，由一串特定顺序排列的词w1,w2,w3,..,wn组成，n是句子的长度。想知道S在文本中(语料库)出现的可能性，也就是数学上所说的概率P(S)：</p>

<p>P(S)=P(w1,w2,w3,..,wn)=P(W1)P(W2|W1)P(W3|W1,W2)..P(Wn|W1,W2,..,Wn−1)</p>

<p>由于要计算wi出现的概率，就要去统计前i-1词出现的情况，假设词库中有n个词，就有n^(i-1)种可能，这样每增加一个单词，模型的计算成本都指数倍的增长。于是，我们做一个简单的马尔科夫假设（Markov Assumption）来简化问题：假设第i个词出现的概率只与前面的N-1个词有关，这就是N-gram语言模型的由来。比如计算的概率时候，我们假设单词wi出现的概率只与前面出现的N个词有关：</p>

<ul>
  <li>当N=1的时候，为一元模型（Unigram model）：P(S)=P(w1,w2,w3,..,wn)=P(W1)*P(W2)*…*P(Wn)</li>
  <li>当N=2的时候，叫二元模型（Bigram model）：P(S)=P(w1,w2,w3,..,wn)=P(W1|start)*P(W2|W1)*…*P(Wn|Wn-1)</li>
  <li>当N=3的时候，叫 三元模型（trigram model）：P(S)=P(w1,w2,w3,..,wn)=P(W2|start,W1)*P(W3|W1,W2)*…*P(Wn|Wn-1,Wn-2)</li>
</ul>

<p>也许你已经意识到，N是一个超参数，在面临实际问题时，我们应该如何选择依赖词的个数？</p>

<ul>
  <li>更大的n：对下一个词出现的约束信息更多，具有更大的辨别力；</li>
  <li>更小的n：在训练语料库中出现的次数更多，具有更可靠的统计信息，具有更高的可靠性。</li>
</ul>

<p>理论上，n越大越好，但在经验上看，trigram用的最多，尽管如此，原则上，能用bigram解决，绝不使用trigram。</p>

<p>对于每一个概率计算我们使用最大似然估计法（Maximum Likelihood Estimate）来做：</p>

<p>p(w1|wi-1) = count(wi-1, wi) / count(wi-1)</p>

<p>如给定句子集：</p>

<p>&lt;s&gt; I am Sam &lt;/s&gt;</p>

<p>&lt;s&gt; Sam I am &lt;/s&gt;</p>

<p>&lt;s&gt; I do not like green eggs and ham &lt;/s&gt;</p>

<p>部分bigram语言模型如下所示：</p>

<p><img title="如何使用N-gram语言模型来进行篇章单元分类？_" 图片1="" src="http://img.mukewang.com/59f83efa0001a1d108820096.jpg" alt="bigram语言模型" style="display:block; margin:auto; width:80%" /></p>

<h2 id="二-基于n-gram模型的篇章单元分类器"><strong>二、 基于N-gram模型的篇章单元分类器</strong></h2>

<p>NLP领域大牛Dan Jurafsky 和 Chirs Manning在他们的斯坦福大学自然语言处理课程中，他们用训练集的9222个句子来统计的部分二元单词分布情况：</p>

<p style="text-align:center">表1 部分二元单词分布情况表</p>

<p><img title="如何使用N-gram语言模型来进行篇章单元分类？_" 图片2="" src="http://img.mukewang.com/59f83f06000153fb13360446.jpg" alt="部分二元单词分布情况表" style="display:block; margin:auto; width:80%" /></p>

<p>第一行，第二列表示给定前一个词是 “i” 时，当前词为“want”的情况一共出现了827次。据此，我们便可以算得相应的频率分布表如下：</p>

<p style="text-align:center">表2 频率分布表</p>

<p><img title="如何使用N-gram语言模型来进行篇章单元分类？_" 图片3="" src="http://img.mukewang.com/59f83f12000164bf13060436.png" alt="频率分布表" style="display:block; margin:auto; width:80%" /></p>

<p>因为我们从表1中知道 “i” 一共出现了2533次，而其后出现 “want” 的情况一共有827次，所以<code class="highlighter-rouge">P(want|i)=827/2533≈0.33</code>。</p>

<p>假设我们现在有一个标记为背景（Background）语料库（由于现在只有两句，所以我们就不画上面的单词分布情况表以及频率分布表了）如下，其中&lt;BG&gt;是句首标记，&lt;/BG&gt;是句尾标记：</p>

<p>&lt;BG&gt;yes no no no no yes&lt;/BG&gt;</p>

<p>&lt;BG&gt;no no no yes yes yes no&lt;/BG&gt;</p>

<p>下面我们的任务是来评估如下这个句子属于“背景”这个篇章单元类别的概率：</p>

<p>s=&lt;BG&gt;yes no no yes&lt;/BG&gt;（先假设这句话的所属篇章单元类别为“背景”，这样我们可以提取第一个单词和最后一个单词的与“背景”相关的特征）</p>

<p>我们来演示利用trigram模型来计算概率的结果：</p>

<p>P(yes|&lt;BG&gt;) = 1/2</p>

<p>P(no|&lt;BG&gt;,yes) = 1</p>

<p>P(no|yes,no) = 1/2</p>

<p>P(yes|no,no) = 2/5</p>

<p>P(&lt;/BG&gt;|no,yes) = 1/2</p>

<p>P(s) = 1/2*1*1/2*2/5*1/2 = 0.05，即句子s属于“背景”的概率为0.05。</p>

<p>为了避免数据溢出、提高性能，通常会使用取log后使用加法运算替代乘法运算。</p>

<p>log(p1*p2*p3*p4) = log(p1) + log(p2) + log(p3) + log(p4)</p>

<p>那么我们如何用N-gram来做篇章单元的分类器呢？其实很简单了，只要根据每个类别的语料库训练各自的语言模型，也就是上面的频率分布表，实质上就是每一个篇章单元的类别都有一个概率分布，当新来一个篇章单元的时候，只要根据各自的语言模型，计算出每个语言模型下这个篇章单元的发生概率，篇章单元在哪个模型的概率大，这篇文本就属于哪个类别了。</p>

<h2 id="三-工具与数据集"><strong>三、 工具与数据集</strong></h2>

<p>推荐开源语言模型工具：</p>

<ol>
  <li>SRILM（http://www.speech.sri.com/projects/srilm/）</li>
  <li>IRSTLM（http://hlt.fbk.eu/en/irstlm）</li>
  <li>MITLM（http://code.google.com/p/mitlm/）</li>
  <li>BerkeleyLM（http://code.google.com/p/berkeleylm/）</li>
</ol>

<p>推荐开源n-gram数据集：</p>

<ol>
  <li>Google Web1T5-gram（http://googleresearch.blogspot.com/2006/08/all-our-n-gram-are-belong-to-you.html）</li>
  <li>Google Book N-grams（http://books.google.com/ngrams/）</li>
  <li>Chinese Web 5-gram（http://www.ldc.upenn.edu/Catalog/catalogEntry.jsp?catalogId=LDC2010T06）</li>
</ol>

<h2 id="四-参考文献"><strong>四、 参考文献</strong></h2>

<ol>
  <li>斯坦福大学自然语言处理第四课“语言模型（Language Modeling）：http://52opencourse.com/111/%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%A4%A7%E5%AD%A6%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%AC%AC%E5%9B%9B%E8%AF%BE-%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%88language-modeling%EF%BC%89</li>
  <li>N-gram语言模型文本分类器：http://blog.csdn.net/shiwei1003462571/article/details/43482881</li>
  <li>Ngram语言模型：https://flystarhe.github.io/2016/08/16/ngram/</li>
</ol>

                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                                <h5 style="display: inline;">Tags:</h5>
                                
                                    <button class="btn btn-white btn-xs" type="button">N-gram</button>
                                
                                    <button class="btn btn-white btn-xs" type="button">篇章单元分类</button>
                                
                        </div>
                        <div class="col-md-6">
                            <div class="small text-right">
                                <h5>Stats:</h5>
                                <div>
                                
                                
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-lg-12">
                            <!-- donate -->
                            
                            <div class="text-center">
<a class="btn btn-warning  dim btn-large-dim btn-outline" href="/donate/"><i class="fa fa-smile-o"></i></a>
</div>

                            
                            <br>
                            <!-- share -->
                            <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<!-- <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_google_plus"></a>
<a class="a2a_button_linkedin"></a> -->
<a class="a2a_button_email"></a>
<a class="a2a_button_wechat" style="margin-left:2%"></a>
<a class="a2a_button_sina_weibo" style="margin-left:2%"></a>
<!-- <a class="a2a_button_pocket"></a> -->
</div>
<script>
var a2a_config = a2a_config || {};
a2a_config.color_main = "D7E5ED";
a2a_config.color_border = "AECADB";
a2a_config.color_link_text = "333333";
a2a_config.color_link_text_hover = "333333";
</script>
<script async src="https://static.addtoany.com/menu/page.js"></script>

                            <br>
                            <!-- comment -->
                            

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>


	
	    <!-- Google analytics -->


<!-- GrowingIO -->





	

</body>
</html>
